/*! www.xiaomi.com - v1.1.0 - 2014 */if("undefined"==typeof XIAOMI||!XIAOMI)var XIAOMI={};XIAOMI.namespace=function(){var i,j,d,a=arguments,o=null;for(i=0;i<a.length;i+=1)for(d=(""+a[i]).split("."),o=XIAOMI,j="XIAOMI"==d[0]?1:0;j<d.length;j+=1)o[d[j]]=o[d[j]]||{},o=o[d[j]];return o},XIAOMI.lang=XIAOMI.lang||{},function(){var L=XIAOMI.lang,OP=Object.prototype,ARRAY_TOSTRING="[object Array]",FUNCTION_TOSTRING="[object Function]",OBJECT_TOSTRING="[object Object]",NOTHING=[],HTML_CHARS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;"},ADD=["toString","valueOf"],OB={isArray:function(o){return OP.toString.apply(o)===ARRAY_TOSTRING},isBoolean:function(o){return"boolean"==typeof o},isFunction:function(o){return"function"==typeof o||OP.toString.apply(o)===FUNCTION_TOSTRING},isNull:function(o){return null===o},isNumber:function(o){return"number"==typeof o&&isFinite(o)},isObject:function(o){return o&&("object"==typeof o||L.isFunction(o))||!1},isString:function(o){return"string"==typeof o},isUndefined:function(o){return"undefined"==typeof o},_IEEnumFix:-[1]?function(){}:function(r,s){var i,fname,f;for(i=0;i<ADD.length;i+=1)fname=ADD[i],f=s[fname],L.isFunction(f)&&f!=OP[fname]&&(r[fname]=f)},escapeHTML:function(html){return html.replace(/[&<>"'\/`]/g,function(match){return HTML_CHARS[match]})},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},extend:function(subc,superc,overrides){if(!superc||!subc)throw new Error("extend failed, please check that all dependencies are included.");var i,F=function(){};if(F.prototype=superc.prototype,subc.prototype=new F,subc.prototype.constructor=subc,subc.superclass=superc.prototype,superc.prototype.constructor==OP.constructor&&(superc.prototype.constructor=superc),overrides){for(i in overrides)L.hasOwnProperty(overrides,i)&&(subc.prototype[i]=overrides[i]);L._IEEnumFix(subc.prototype,overrides)}},augmentObject:function(r,s){if(!s||!r)throw new Error("Absorb failed, verify dependencies.");var i,p,a=arguments,overrideList=a[2];if(overrideList&&overrideList!==!0)for(i=2;i<a.length;i+=1)r[a[i]]=s[a[i]];else{for(p in s)!overrideList&&p in r||(r[p]=s[p]);L._IEEnumFix(r,s)}return r},augmentProto:function(r,s){if(!s||!r)throw new Error("Augment failed, verify dependencies.");var i,a=[r.prototype,s.prototype];for(i=2;i<arguments.length;i+=1)a.push(arguments[i]);return L.augmentObject.apply(this,a),r},dump:function(o,d){var i,len,s=[],OBJ="{...}",FUN="f(){...}",COMMA=", ",ARROW=" => ";if(!L.isObject(o))return o+"";if(o instanceof Date||"nodeType"in o&&"tagName"in o)return o;if(L.isFunction(o))return FUN;if(d=L.isNumber(d)?d:3,L.isArray(o)){for(s.push("["),i=0,len=o.length;len>i;i+=1)s.push(L.isObject(o[i])?d>0?L.dump(o[i],d-1):OBJ:o[i]),s.push(COMMA);s.length>1&&s.pop(),s.push("]")}else{s.push("{");for(i in o)L.hasOwnProperty(o,i)&&(s.push(i+ARROW),s.push(L.isObject(o[i])?d>0?L.dump(o[i],d-1):OBJ:o[i]),s.push(COMMA));s.length>1&&s.pop(),s.push("}")}return s.join("")},substitute:function(s,o,f,recurse){for(var i,j,k,key,v,meta,token,dump,objstr,saved=[],lidx=s.length,DUMP="dump",SPACE=" ",LBRACE="{",RBRACE="}";(i=s.lastIndexOf(LBRACE,lidx),!(0>i))&&(j=s.indexOf(RBRACE,i),!(i+1>j));)token=s.substring(i+1,j),key=token,meta=null,k=key.indexOf(SPACE),k>-1&&(meta=key.substring(k+1),key=key.substring(0,k)),v=o[key],f&&(v=f(key,v,meta)),L.isObject(v)?L.isArray(v)?v=L.dump(v,parseInt(meta,10)):(meta=meta||"",dump=meta.indexOf(DUMP),dump>-1&&(meta=meta.substring(4)),objstr=v.toString(),v=objstr===OBJECT_TOSTRING||dump>-1?L.dump(v,parseInt(meta,10)):objstr):L.isString(v)||L.isNumber(v)||(v="~-"+saved.length+"-~",saved[saved.length]=token),s=s.substring(0,i)+v+s.substring(j+1),recurse===!1&&(lidx=i-1);for(i=saved.length-1;i>=0;i-=1)s=s.replace(new RegExp("~-"+i+"-~"),"{"+saved[i]+"}","g");return s},trim:function(s){try{return s.replace(/^\s+|\s+$/g,"")}catch(e){return s}},merge:function(){var i,o={},a=arguments,l=a.length;for(i=0;l>i;i+=1)L.augmentObject(o,a[i],!0);return o},later:function(when,o,fn,data,periodic){when=when||0,o=o||{};var f,r,m=fn,d=data;if(L.isString(fn)&&(m=o[fn]),!m)throw new TypeError("method undefined");return L.isUndefined(data)||L.isArray(d)||(d=[data]),f=function(){m.apply(o,d||NOTHING)},r=periodic?setInterval(f,when):setTimeout(f,when),{interval:periodic,cancel:function(){this.interval?clearInterval(r):clearTimeout(r)}}},isValue:function(o){return L.isObject(o)||L.isString(o)||L.isNumber(o)||L.isBoolean(o)}};L.hasOwnProperty=OP.hasOwnProperty?function(o,prop){return o&&o.hasOwnProperty&&o.hasOwnProperty(prop)}:function(o,prop){return!L.isUndefined(o[prop])&&o.constructor.prototype[prop]!==o[prop]},OB.augmentObject(L,OB,!0),L.augment=L.augmentProto,XIAOMI.augment=L.augmentProto,XIAOMI.extend=L.extend}();;(function(){function parse(s,buf,offset){var i=buf&&offset||0,ii=0;for(buf=buf||[],s.toLowerCase().replace(/[0-9a-f]{2}/g,function(oct){16>ii&&(buf[i+ii++]=_hexToByte[oct])});16>ii;)buf[i+ii++]=0;return buf}function unparse(buf,offset){var i=offset||0,bth=_byteToHex;return bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]}function v1(options,buf,offset){var i=buf&&offset||0,b=buf||[];options=options||{};var clockseq=null!=options.clockseq?options.clockseq:_clockseq,msecs=null!=options.msecs?options.msecs:(new Date).getTime(),nsecs=null!=options.nsecs?options.nsecs:_lastNSecs+1,dt=msecs-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(0>dt&&null==options.clockseq&&(clockseq=clockseq+1&16383),(0>dt||msecs>_lastMSecs)&&null==options.nsecs&&(nsecs=0),nsecs>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=msecs,_lastNSecs=nsecs,_clockseq=clockseq,msecs+=122192928e5;var tl=(1e4*(268435455&msecs)+nsecs)%4294967296;b[i++]=tl>>>24&255,b[i++]=tl>>>16&255,b[i++]=tl>>>8&255,b[i++]=255&tl;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255,b[i++]=255&tmh,b[i++]=tmh>>>24&15|16,b[i++]=tmh>>>16&255,b[i++]=clockseq>>>8|128,b[i++]=255&clockseq;for(var node=options.node||_nodeId,n=0;6>n;n++)b[i+n]=node[n];return buf?buf:unparse(b)}function v4(options,buf,offset){var i=buf&&offset||0;"string"==typeof options&&(buf="binary"==options?new BufferClass(16):null,options=null),options=options||{};var rnds=options.random||(options.rng||_rng)();if(rnds[6]=15&rnds[6]|64,rnds[8]=63&rnds[8]|128,buf)for(var ii=0;16>ii;ii++)buf[i+ii]=rnds[ii];return buf||unparse(rnds)}var _rng,_global=this;if("function"==typeof require)try{var _rb=require("crypto").randomBytes;_rng=_rb&&function(){return _rb(16)}}catch(e){}if(!_rng&&_global.crypto&&crypto.getRandomValues){var _rnds8=new Uint8Array(16);_rng=function(){return crypto.getRandomValues(_rnds8),_rnds8}}if(!_rng){var _rnds=new Array(16);_rng=function(){for(var r,i=0;16>i;i++)0===(3&i)&&(r=4294967296*Math.random()),_rnds[i]=r>>>((3&i)<<3)&255;return _rnds}}for(var BufferClass="function"==typeof Buffer?Buffer:Array,_byteToHex=[],_hexToByte={},i=0;256>i;i++)_byteToHex[i]=(i+256).toString(16).substr(1),_hexToByte[_byteToHex[i]]=i;var _seedBytes=_rng(),_nodeId=[1|_seedBytes[0],_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]],_clockseq=16383&(_seedBytes[6]<<8|_seedBytes[7]),_lastMSecs=0,_lastNSecs=0,uuid=v4;if(uuid.v1=v1,uuid.v4=v4,uuid.parse=parse,uuid.unparse=unparse,uuid.BufferClass=BufferClass,_global.define&&define.amd)define(function(){return uuid});else if("undefined"!=typeof module&&module.exports)module.exports=uuid;else{var _previousRoot=_global.uuid;uuid.noConflict=function(){return _global.uuid=_previousRoot,uuid},_global.uuid=uuid}}).call(this);;XIAOMI.namespace("app.analytics"),XIAOMI.app.analytics=function(element,options){this.options={page:"首页",position:["A1"],url:!0,BDurl:!0,mstSite:"CN-WW",mstPage:"PC",mstArea:"RM",mstPosition:["A"],mstHostParams:"",isMst:!1,JQelement:!1};for(var p in options)this.options[p]=options[p];for(var _this=this,isUrl=_this.options.url?!0:!1,isBDurl=_this.options.BDurl?!0:!1,bindFunction=function(links){$.each(links,function(k,v){var mstParamString=isUrl?$(v).attr("href"):XIAOMI.lang.trim($(v).text()),BDparamString=isBDurl?$(v).attr("href"):XIAOMI.lang.trim($(v).text()),paramIndex=k,BDparmas_1=_this.options.page,BDparmas_2=BDparmas_1+"_"+_this.options.position[i]+"_"+paramIndex,BDparmas_3=BDparmas_2+"_"+BDparamString,BDparmas="'PC','"+BDparmas_3+"'",mstParmas="'"+_this.options.mstSite+"-"+_this.options.mstPage+"-"+_this.options.mstArea+"-"+_this.options.mstPosition[i]+paramIndex+"', '"+mstParamString;mstParmas=mstParmas+=""===_this.options.mstHostParams?"', '"+paramIndex+"'":"', '"+_this.options.mstHostParams+"'",_this.options.isMst?$(v).attr("onclick","_msq.push(['trackEvent',"+mstParmas+"]);_hmt.push(['_trackEvent',"+BDparmas+"]);"):$(v).attr("onclick","_hmt.push(['_trackEvent',"+BDparmas+"]);")})},i=0;i<element.length;i++){var links=_this.options.JQelement?element[i]:$(element[i]).find("a");bindFunction(links)}},XIAOMI.namespace("app.updateMiniCart, app.addShopCart, app.addShopCartEvent"),XIAOMI.app.updateMiniCart=function(){var num=XIAOMI.app.cookie("xm_user_www_num");return num&&parseFloat(num)>0?($(".J_cartNum").html("("+num+")").show(),num):($(".J_cartNum").html("").hide(),0)},XIAOMI.app.addShopCart=function(gid,callback,obj){if(gid&&"function"==typeof callback){var ajaxUrl=XIAOMI.GLOBAL_CONFIG.orderSite+"/cart/add/"+gid;$.ajax({url:ajaxUrl,dataType:"jsonp",jsonp:"jsonpcallback",success:function(data){callback(data,obj),XIAOMI.app.updateMiniCart()}})}},XIAOMI.app.addShopCartEvent=function(options){var op={obj:".xmAddShopCart",callback:null};$.extend(op,options||{}),$(document).on("click",op.obj,function(){var gid=$(this).attr("data-gid"),isDisabled=$(this).attr("data-disabled"),isPackage=$(this).attr("data-package");if("false"===isDisabled){if($(this).attr("data-disabled","true"),!gid||"true"===isPackage||null===op.callback)return!0;var dmSkuArr=XIAOMI.GLOBAL_CONFIG.damiaoGoodsId?XIAOMI.GLOBAL_CONFIG.damiaoGoodsId:!1,isToDm=!1;if(dmSkuArr!==!1&&"object"==typeof dmSkuArr)for(var i=0;i<dmSkuArr.length;i+=1)if(gid===dmSkuArr[i]){isToDm=!0;break}if(isToDm===!0){var dmLogin=new XIAOMI.app.miniLogin;XIAOMI.app.cookie("serviceToken")?XIAOMI.app.dmFun.init({sku:gid,callback:op.callback,obj:$(this)}):XIAOMI.app.cookie("userId")?(dmLogin._proxyiframe(),XIAOMI.app.dmFun.init({sku:gid,callback:op.callback,obj:$(this)})):dmLogin._toLogin()}else XIAOMI.app.addShopCart(gid,op.callback,$(this))}return!1})},function(){for(var method,noop=function(){},methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],length=methods.length,console=window.console=window.console||{};length--;)method=methods[length],console[method]||(console[method]=noop)}(),XIAOMI.namespace("app.cookie"),XIAOMI.app.cookie=function(key,value,options){if(arguments.length>1&&"[object Object]"!==String(value)){if(options=jQuery.extend({},options),(null===value||void 0===value)&&(options.expires=-1),"number"==typeof options.expires){var days=options.expires,t=options.expires=new Date;t.setDate(t.getDate()+days)}return value=String(value),document.cookie=[encodeURIComponent(key),"=",options.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")}options=value||{};var result,decode=options.raw?function(s){return s}:decodeURIComponent;return(result=new RegExp("(?:^|; )"+encodeURIComponent(key)+"=([^;]*)").exec(document.cookie))?decode(result[1]):null},XIAOMI.namespace("app.dmFun"),XIAOMI.app.dmFun={init:function(options){this.config={sku:null,callback:null,obj:null,sourceVal:"bigtap"},this.inTheQueue=!1,$.extend(this.config,options),this.startQueue(),this.getDmSys();var _this=this;$("#xmDmReload").on("click",function(){_this.config.obj.trigger("click")})},getDmSys:function(){var _this=this,hdget=XIAOMI.GLOBAL_CONFIG.damiaoSite+"hdget/cn?source="+_this.config.sourceVal+"&product="+_this.config.sku+"&addcart=1&m=1&_="+(new Date).getTime();$.ajax({type:"GET",url:hdget,dataType:"jsonp",jsonp:"jsonpcallback",jsonpCallback:"hdcontrol",timeout:3e4,error:function(){return _this.inTheQueue?(_this.stopQueue(),void $("#xmDmError").modal({show:!0,backdrop:"static"})):!1},success:function(data){var jsonStr=data.status,token=jsonStr[_this.config.sku].hdurl,isOver=jsonStr[_this.config.sku].hdstart===!1&&jsonStr[_this.config.sku].hdstop===!0?!0:!1,speed=data.d22a51?1e3*data.d22a51:5e3;return _this.inTheQueue?isOver===!0?(_this.stopQueue(),alert("抱歉，商品已售罄！"),!1):(_this.getDmTimer&&clearTimeout(_this.getDmTimer),void(token?_this.getShopCart(token):(_this.inTheQueue||_this.startQueue(),_this.getDmTimer=setTimeout(function(){_this.getDmSys()},speed)))):!1}})},getShopCart:function(token){if(!token)return!1;var _this=this,addCart=XIAOMI.GLOBAL_CONFIG.orderSite+"/cart/add/"+this.config.sku+"?source="+_this.config.sourceVal+"&token="+token;$.ajax({type:"GET",url:addCart,dataType:"jsonp",jsonp:"jsonpcallback",success:function(data){_this.stopQueue(),_this.config.callback(data,_this.config.obj),XIAOMI.app.updateMiniCart()}})},startQueue:function(){var _this=this;$("#xmDmError").modal("hide"),$("#xmDmQueue").modal({show:!0,backdrop:"static"}),_this.queueAnimate(),_this.inTheQueue=!0,$("#xmDmQueue").on("hidden.bs.modal",function(){_this.stopQueue(),_this.config.obj.attr("data-disabled","false")})},stopQueue:function(){$("#xmDmQueue").modal("hide"),this.inTheQueue=!1,this.getDmTimer&&clearTimeout(this.getDmTimer),window.queueAnimateTimer&&clearInterval(queueAnimateTimer)},queueAnimate:function(){var flag=0,speed=200,loop=function(){flag-=90,-900>=flag&&(flag=0),$("#mituWalking").css({"background-position":flag+"px 0"})};window.queueAnimateTimer=setInterval(loop,speed)},showLoading:function(){var _this=this;$("#getDmLoading").modal("show"),$("#getDmLoading").on("hidden.bs.modal",function(){_this.config.obj.attr("data-disabled","false")})},hideLoading:function(){$("#getDmLoading").modal("hide")}},XIAOMI.namespace("app.footer"),XIAOMI.app.footer={init:function(){var _this=this;_this.retinizer(),_this.weixin(),_this.siteList(),XIAOMI.app.analytics([".J_menuNavMain"],{page:"导航",position:["A"],mstPage:"HP",mstArea:"NV",mstPosition:["A"],isMst:!0})},retinizer:function(){var img=new Image;if("srcset"in img)return!1;if("undefined"==typeof window.devicePixelRatio||window.devicePixelRatio<=1.5)return!1;var $img=$("img");$img.each(function(){var srcset=$(this).attr("srcset");srcset&&srcset.split(" 2x")[0]&&$(this).attr("src",srcset.split(" 2x")[0])})},siteList:function(){$(".J_globalList").on({mouseenter:function(){$(this).find(".global-site-list").show()},mouseleave:function(){$(this).find(".global-site-list").hide()}})},weixin:function(){$(".J_modalWeixin").on("click",function(){var $modalWeixin=$("#J_modalWeixin");$modalWeixin.css({width:$modalWeixin.attr("data-width"),height:$modalWeixin.attr("data-height")}).modal({backdrop:!0,keyboard:!0,show:!0})})}},XIAOMI.namespace("app.getRegions"),XIAOMI.app.getRegions={getUrl:"/region/index",getData:function(parent,target,sId){var _this=this;$.ajax({type:"GET",url:_this.getUrl,data:"parent="+parent,dataType:"json",success:function(data){data&&_this.formatData(data,target,sId)}})},formatData:function(jsonData,target,sId){for(var dataArray=jsonData.regions,lens=dataArray.length,obj=$("#"+target),options="<option value='0'>"+obj.children("option").eq(0).html()+"</option>",i=0;lens>i;i+=1){var isSelected=dataArray[i].region_id===sId?"selected":"";options+="<option zipcode='"+dataArray[i].zipcode+"' value='"+dataArray[i].region_id+"'"+isSelected+">"+dataArray[i].region_name+"</option>"}$("#"+target).html(options).attr("disabled",!1)}},XIAOMI.namespace("app.History"),XIAOMI.app.History=function(){var historyVal=XIAOMI.app.cookie("XM_scan_history"),itemArray=null,goodsUrl=null;if(!historyVal)return!1;historyVal=historyVal.split("#m#");for(var lens=historyVal.length-1,objArr=[],i=0;lens>i;i++){itemArray=historyVal[i].split(","),goodsUrl=XIAOMI.GLOBAL_CONFIG.wwwSite+"/item/"+itemArray[3];var pro={};pro.imgUrl=itemArray[0],pro.goodsUrl=goodsUrl,pro.name=itemArray[1],pro.price=itemArray[2],pro.starClass=itemArray[4],pro.gid=itemArray[3],objArr.push(pro)}return objArr},XIAOMI.namespace("app.miniCart"),XIAOMI.app.miniCart={elmCartBtn:$("#J_miniCart"),elmCartList:$("#J_miniCartList"),loadingStr:'<p class="loading">数据加载中，请稍后...</p>',speed:500,init:function(){var _this=this,timeOut=null;return"undefined"!=typeof miniCartDisable&&miniCartDisable?!1:"undefined"!=typeof XIAOMI.GLOBAL_CONFIG.closeMiniCart&&"1"===XIAOMI.GLOBAL_CONFIG.closeMiniCart?!1:(_this.elmCartBtn.on({mouseenter:function(){clearTimeout(timeOut),$(this).hasClass("mini-cart-on")||($(this).addClass("mini-cart-on"),_this.show(),_this.getData())},mouseleave:function(){timeOut=setTimeout(function(){_this.close()},_this.speed)}}),_this.elmCartList.on({mouseenter:function(){clearTimeout(timeOut)},mouseleave:function(){timeOut=setTimeout(function(){_this.close()},_this.speed)}}),void _this.elmCartList.on("click",".delItem",function(e){var gId=$(this).attr("gid"),isBigtap=$(this).attr("data-isbigtap");return"true"!==isBigtap||confirm("您正在删除开放购买活动商品\n\n删除后您失去本次开放购买资格，无法下单购买此商品。\n确认删除此商品吗？")?(e.preventDefault(),void _this.delGoods(gId)):!1}))},show:function(){var _this=this;_this.elmCartList.show()},close:function(){var _this=this;_this.elmCartBtn.removeClass("mini-cart-on"),_this.elmCartList.html(this.loadingStr).hide()},delGoods:function(gId){var _this=this;$.ajax({type:"POST",url:XIAOMI.GLOBAL_CONFIG.orderSite+"/cart/delete/"+gId,dataType:"jsonp",jsonp:"jsonpcallback",cache:"false",success:function(data){1===data.code?(_this.getData(),XIAOMI.app.updateMiniCart()):alert(data.msg)}})},getData:function(){var _this=this;$.ajax({type:"POST",url:XIAOMI.GLOBAL_CONFIG.orderSite+"/cart/miniNew",dataType:"jsonp",jsonp:"jsonpcallback",cache:!1,success:function(data){_this.formatData(data),XIAOMI.app.updateMiniCart()}})},formatData:function(data){var _this=this;if(0===data.errorno&&data.totalItem>0){var lens=data.items.length,goodsUrl=null,listHtml="<ul>",countHtml='<div class="count clearfix"><span class="total">共计 <em>'+data.total+"</em> 件商品<strong>合计：<em>"+data.totalPrice+'元</em></strong></span><a href="'+XIAOMI.GLOBAL_CONFIG.orderSite+'/cart"  class="btn btn-primary">去购物车结算</a></div>';if(data.totalItem>5){var listHeight=335;listHtml='<ul style="height:'+listHeight+'px;overflow-x:hidden;overflow-y:scroll">'}for(var i=0;lens>i;i+=1){var isCos="",cosMask="",price=data.items[i].salePrice+"元 x "+data.items[i].num;data.items[i].is_cos===!0&&(isCos="is-cos",cosMask='<div class="cos-mask"></div>',price="暂时缺货"),0===data.items[i].noLink?(goodsUrl=XIAOMI.GLOBAL_CONFIG.orderSite+"/item/"+data.items[i].product_id,listHtml+='<li class="clearfix '+isCos+'"><a href="'+goodsUrl+'" class="pic"><img alt="" src="'+data.items[i].image_url+'?width=60&height=60"></a><a href="'+goodsUrl+'" class="name">'+data.items[i].product_name+'</a><span class="price">'+price+'</span><a class="btn-del delItem" href="javascript: void(0);" gid="'+data.items[i].itemId+'" data-isBigtap="'+data.items[i].is_bigtap+'"><i class="iconfont">&#xe607;</i></a>'+cosMask+"</li>"):listHtml+='<li class="clearfix '+isCos+'"><span class="pic"><img alt="" src="'+data.items[i].image_url+'"></span><span   class="name">'+data.items[i].product_name+'</span><span class="price">'+price+'</span><a class="btn-del delItem" href="javascript: void(0);" gid="'+data.items[i].itemId+'" data-isBigtap="'+data.items[i].is_bigtap+'"><i class="iconfont">&#xe607;</i></a>'+cosMask+"</li>"}listHtml+="</ul>",_this.elmCartList.html(listHtml+countHtml)}else 0===data.errorno&&_this.elmCartList.html('<p class="loading">购物车中还没有商品，赶紧选购吧！</p>')}},XIAOMI.namespace("app.miniLogin"),XIAOMI.app.miniLogin=function(){this.orderSite=XIAOMI.GLOBAL_CONFIG.orderSite,this.quickLoginUrl=XIAOMI.GLOBAL_CONFIG.quickLoginUrl},XIAOMI.app.miniLogin.prototype={constructor:XIAOMI.app.miniLogin,_proxyiframe:function(){var iframesrc=this.orderSite+"/user/proxy/stop/1",iframebody="<iframe src='"+iframesrc+"' width='0' height='0' name='proxy' id='proxy' frameborder='0' scrolling='no'></iframe>";$(document.body).append(iframebody),$("iframe[name='proxy']").load(function(){$("iframe[name='proxy']").remove()})},_toLogin:function(rel){function appendTobody(url){var iframeURL=url?url:_this.quickLoginUrl,content="<iframe src='"+iframeURL+"' width='100%' height='100%' name='miniLoginFrame' id='miniLoginFrame' frameborder='0' scrolling='no'></iframe>",boxWidth=$("#loginBox").attr("data-width"),boxHeight=$("#loginBox").attr("data-Height");$("#loginBox-con").css({height:boxHeight}).html(content),$("#loginBox").css({width:boxWidth,"margin-left":-boxWidth/2}).modal({backdrop:!0,keyboard:!0,show:!0})}function goLocation(){clearInterval(timer),rel?window.location.href=rel:window.location.reload(!0)}function checkHash(){-1!==window.location.href.indexOf("order")?XIAOMI.app.cookie("serviceToken")&&goLocation():XIAOMI.app.cookie("userId")&&goLocation()}var _this=this,shref=encodeURIComponent(window.location.href);$.ajax({url:_this.orderSite+"/site/loginurl?followup="+shref,dataType:"jsonp",jsonp:"jsonpcallback",success:function(data){appendTobody(data.url)},Complete:function(){},error:function(){appendTobody()}});var timer=window.setInterval(checkHash,1e3)},init:function(){var _this=this;-1!==window.location.pathname.indexOf("cart")&&XIAOMI.app.cookie("userId")&&!XIAOMI.app.cookie("serviceToken")&&_this._proxyiframe(),$("[data-needLogin='true']").on("click",function(){window.location.href="https://account.xiaomi.com/pass/serviceLogin"})},_isLogined:function(rel,e){XIAOMI.app.cookie("serviceToken")||(XIAOMI.app.cookie("userId")?this._proxyiframe():(e&&XIAOMI.lang.preventDefault(e),this._toLogin(rel)))},autoExec:function(rel){this._isLogined(rel)}},XIAOMI.namespace("app.navMenus, app.navigation"),XIAOMI.app.navMenus=function(){function toggleMenu(elm,curIndex,show,opt){var options,$menu,$elm=$(elm);return options=$.extend({},defaults,opt),$menu=$elm.children(options.menuSelector),"toggle"===options.effect?show?$menu.removeClass("current").children(options.submenuSelector).hide().end().eq(curIndex).addClass("current").children(options.submenuSelector).show():$menu.removeClass("current").children(options.submenuSelector).hide():"slide"===options.effect?show?($menu.removeClass("current").children(options.submenuSelector).stop(!0,!0).delay(options.speed).slideUp(options.speed),$menu.eq(curIndex).addClass("current").children(options.submenuSelector).stop(!0,!0).slideDown(options.speed)):$menu.removeClass("current").children(options.submenuSelector).stop(!0,!0).slideUp(options.speed):"fade"===options.effect&&(show?($menu.removeClass("current").children(options.submenuSelector).stop(!0,!0).fadeOut(options.speed),$menu.eq(curIndex).children(options.submenuSelector).stop(!0,!0).fadeIn(options.speed)):$menu.removeClass("current").children(options.submenuSelector).stop(!0,!0).fadeOut(options.speed)),$menu.eq(curIndex).children(options.submenuSelector)}function init(elm,opt){function bindToggleEvent(curIndex,show){options.delay>0&&"click"!==options.triggerEvent?show?(timeoutToggle&&window.clearTimeout(timeoutToggle),timeoutToggle=window.setTimeout(function(){toggleMenu($elm,curIndex,!0,options)},options.delay)):(window.clearTimeout(timeoutToggle),timeoutToggle=window.setTimeout(function(){toggleMenu($elm,curIndex,!1,options)},options.delay)):show?toggleMenu($elm,curIndex,!0,options):toggleMenu($elm,curIndex,!1,options),"function"==typeof options.callback&&options.callback($elm,curIndex,options)}var options,$menu,timeoutToggle,$elm=$(elm);return 0===$elm.length?$elm:$elm.length>1?($elm.each(function(){init($(this),opt)}),this):(options=$.extend({},defaults,opt),$menu=$elm.children(options.menuSelector),"hover"===options.triggerEvent?$menu.on({mouseenter:function(){bindToggleEvent($menu.index($(this)),!0)},mouseleave:function(){bindToggleEvent($menu.index($(this)),!1)}}):"click"===options.triggerEvent&&$menu.on("click",function(e){e.preventDefault(),$(this).hasClass("toggled")?($(this).removeClass("toggled"),bindToggleEvent($menu.index($(this)),!1)):($menu.removeClass("toggled"),$(this).addClass("toggled"),bindToggleEvent($menu.index($(this)),!0))}),void(window.ActiveXObject&&!window.XMLHttpRequest&&$menu.find(options.submenuSelector).find("a").on("click",function(){window.location.href=$(this).attr("href")})))}var defaults;return defaults={menuSelector:".menu",submenuSelector:".children",triggerEvent:"hover",effect:"toggle",delay:200,speed:200,callback:function(){}},{toggleMenu:toggleMenu,init:init}}(),XIAOMI.app.navCategory=function(){function lazyLoadImg(elm){var $elm=$(elm);$elm.each(function(){$(this).hasClass("img-loaded")||"string"!=typeof $(this).attr("data-src")||$(this).addClass("img-loaded").attr({src:$(this).attr("data-src")})})}function addSrcset(elm){var $imgs=elm.find("img");$imgs.each(function(){if(/40x40/.test($(this).attr("data-src"))){var url2x=$(this).attr("data-src").replace("40x40","80x80");$(this).attr("srcset",url2x+" 2x")}})}function toggleCategoryList(option){"show"===option?($categoryContainer.addClass("nav-category-toggled"),$categoryTriggerBtn.find(".iconfont").html("&#xe606;"),$categoryList.show()):"static"===option?($categoryContainer.addClass("nav-category-toggled"),$categoryList.show()):($categoryContainer.removeClass("nav-category-toggled"),$categoryTriggerBtn.find(".iconfont").html("&#xe608;"),$categoryList.hide().find(".nav-category-list").children("li").removeClass("current"))}function bindChildrenList(){var timeoutChildrenList;$categoryList.find(".nav-category-list").children("li").on({mouseenter:function(){var $this=$(this);window.clearTimeout(timeoutChildrenList),$this.hasClass("current")||(timeoutChildrenList=window.setTimeout(function(){$this.addClass("current").siblings("li").removeClass("current");var $children=$this.find(".nav-category-children");if($children.length){if($children.offset().top-$categoryContainer.offset().top-$categoryContainer.height()+$children.height()>$categoryList.height()){var bottomFix=$children.offset().top-$categoryContainer.offset().top-$categoryContainer.height()+73-$categoryList.height();$children.css({top:"auto",bottom:bottomFix})}addSrcset($children),lazyLoadImg($children.find("img"))}},100))},mouseleave:function(){var $this=$(this);window.clearTimeout(timeoutChildrenList),timeoutChildrenList=window.setTimeout(function(){$this.removeClass("current")},100)}})}function init(){var isCategoryStatic="undefined"!=typeof isCategoryToggled?isCategoryToggled:!1,templateHtml='{{? it.children}}<li class="nav-category-item nav-category-item-first"><div class="nav-category-content"><a class="title" href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+'/event/buyphone">购买手机</a><div class="links"><a href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+'/buyphone/mi4">小米4</a><a href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+'/buyphone/mi3">小米3</a><a href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+'/buyphone/hongmi1s">红米</a><a href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+'/buyphone/note">红米Note</a></div><div class="nav-category-children"><ul class="children-list"><li><a href="http://www.mi.com/buyphone/mi4"><img src="http://img03.mifile.cn/webfile/images/2014/cn/placeholder-80.png" width="40" height="40"data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mi4.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mi4_2x.jpg 2x" alt="购买小米手机4"><span class="text">小米手机4</span></a></li><li><a href="http://www.mi.com/buyphone/mi3"><img src="http://img03.mifile.cn/webfile/images/2014/cn/placeholder-80.png" width="40" height="40"data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mi3.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mi3_2x.jpg 2x" alt="购买小米手机3"><span class="text">小米手机3</span></a></li><li><a href="http://www.mi.com/buyphone/hongmi1s"><img src="http://img03.mifile.cn/webfile/images/2014/cn/placeholder-80.png" width="40" height="40"data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/redmi1s.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/redmi1s_2x.jpg 2x" alt="购买红米手机1S"><span class="text">红米手机1S</span></a></li><li><a href="http://www.mi.com/buyphone/note"><img src="http://img03.mifile.cn/webfile/images/2014/cn/placeholder-80.png" width="40" height="40"data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/redminote.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/redminote_2x.jpg 2x" alt="购买红米Note"><span class="text">红米Note</span></a></li><li><a href="http://www.mi.com/c/peijian/"><img src="http://img03.mifile.cn/webfile/images/2014/cn/placeholder-80.png" width="40" height="40"data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/typeacc.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/typeacc_2x.jpg 2x" alt="根据机型选配件"><span class="text">根据机型选配件</span></a></li></ul><div class="children-special-section"><h4>明星配件</h4><ul><li><a href="http://www.mi.com/shouhuan">小米手环 79元</a></li><li><a href="http://www.mi.com/accessories/102">小米活塞耳机 99元</a></li></ul></div></div></div></li><li class="nav-category-item"><div class="nav-category-content"><a class="title" href="javascript: void(0);">购买电视与平板</a><div class="links"><a href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+'/static/buymitv">小米电视</a><a href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+'/static/buyhezi">小米盒子</a><a href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+'/static/buymipad">小米平板</a></div><div class="nav-category-children"><ul class="children-list"><li><a href="http://www.mi.com/static/buymitv"><img src="http://img03.mifile.cn/webfile/images/2014/cn/placeholder-80.png" width="40" height="40"data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mitv.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mitv_2x.jpg 2x" alt="购买小米电视2"><span class="text">小米电视2</span></a></li><li><a href="http://www.mi.com/static/buyhezi"><img src="http://img03.mifile.cn/webfile/images/2014/cn/placeholder-80.png" width="40" height="40"data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mibox.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mibox_2x.jpg 2x" alt="购买小米盒子"><span class="text">小米盒子</span></a></li><li><a href="http://www.mi.com/static/buymipad"><img src="http://img03.mifile.cn/webfile/images/2014/cn/placeholder-80.png" width="40" height="40"data-src="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mipad.jpg" srcset="http://img03.mifile.cn/webfile/images/2014/cn/nav/icons/mipad_2x.jpg 2x" alt="购买小米平板"><span class="text">小米平板</span></a></li></ul><div class="children-special-section"><h4>明星配件</h4><ul><li><a href="http://www.mi.com/accessories/0-256">小米电视配件</a></li><li><a href="http://www.mi.com/accessories/0-8">小米盒子配件</a></li><li><a href="http://www.mi.com/accessories/0-4567890">小米平板配件</a></li></ul></div></div></li>{{~it.children :value:index}} {{? index < 6}}<li class="nav-category-item"><div class="nav-category-content"><a class="title" href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+'/accessories/{{= value.cat_id }}">{{= value.name_alias || value.cat_name }}</a><div class="links">{{~value.highlight_children :highlight_value:highlight_index}}<a href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+'/accessories/{{= highlight_value.cat_id }}">{{= highlight_value.cat_name }}</a>{{~}}</div>{{? value.children}}<div class="nav-category-children"><ul class="children-list">{{~value.children :children_value:children_index}}<li><a href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+'/accessories/{{= children_value.cat_id }}"><img src="http://img03.mifile.cn/webfile/images/2014/cn/placeholder-80.png" width="40" height="40"data-src="{{= children_value.cat_icon }}" alt="{{= children_value.cat_name }}"><span class="text">{{= children_value.cat_name }}</span></a></li>{{~}}</ul>{{? value.topsales.length > 0 }}<div class="children-special-section"><h4>热门商品</h4><ul>{{~value.topsales :topsales_value:topsales_index}}<li><a href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+'/item/{{= topsales_value.id}}">{{= topsales_value.name_alias || topsales_value.name }} {{= topsales_value.price_max }}元</a></li>{{~}}</ul></div>{{?}}</div>{{?}}</div></li>{{?}} {{~}}{{?}}',templateCategory=doT.template(templateHtml);if("undefined"==typeof categoryTree)return!1;if($("#J_categoryContainer").find(".nav-category-list").html(templateCategory(categoryTree)),XIAOMI.app.analytics([$(".nav-category-content > a"),$(".nav-category-content .links").find("a"),$(".nav-category-content .children-list").find("a"),$(".nav-category-content .children-special-section").find("a")],{page:"分类导航",position:["A","B","C","D"],mstPage:"HP",mstArea:"PC",mstPosition:["A","B","C","D"],JQelement:!0,isMst:!0,BDurl:!1}),isCategoryStatic)toggleCategoryList("static");else{$categoryTriggerBtn.append('<i class="iconfont">&#xe608;</i>');var timeoutCategory;$categoryContainer.on({mouseenter:function(){window.clearTimeout(timeoutCategory),$(this).hasClass("nav-category-toggled")||(timeoutCategory=window.setTimeout(function(){toggleCategoryList("show")},200))},mouseleave:function(){window.clearTimeout(timeoutCategory),$(this).hasClass("nav-category-toggled")&&(timeoutCategory=window.setTimeout(function(){toggleCategoryList("hide")},200))}})}bindChildrenList()}var $categoryContainer=$("#J_categoryContainer"),$categoryTriggerBtn=$categoryContainer.children(".btn-category-list"),$categoryList=$categoryContainer.children(".nav-category-section");return{init:init}}(),XIAOMI.namespace("app.placeholder"),XIAOMI.app.placeholder=function(el,opt){var defaults,options,elmPlaceholder,elm=$(el),isPlaceholderSupported="placeholder"in document.createElement("input");return 0===elm.length?elm:elm.length>1?(elm.each(function(){XIAOMI.app.placeholder($(this),opt)}),this):(defaults={blurClass:"xm-ph-blur"},options=$.extend({},defaults,opt),elmPlaceholder=elm.attr("placeholder"),void(!isPlaceholderSupported&&elmPlaceholder&&(elm.is("textarea")?""===elm.html()&&elm.addClass(options.blurClass).html(elmPlaceholder):""===elm.val()&&elm.addClass(options.blurClass).val(elmPlaceholder),elm.on({focus:function(){$(this).is("textarea")?$(this).html()===elmPlaceholder&&$(this).removeClass(options.blurClass).html(""):$(this).val()===elmPlaceholder&&$(this).removeClass(options.blurClass).val("")},blur:function(){$(this).is("textarea")?""===$(this).html()&&$(this).addClass(options.blurClass).html(elmPlaceholder):""===$(this).val()&&$(this).addClass(options.blurClass).val(elmPlaceholder)}}))))},XIAOMI.namespace("app.carousel"),XIAOMI.app.carousel=function(){function init(elm,opt){function slideList(targetPage){var offsetX="-"+targetPage*itemWidth*itemPerSlide+"px";$list.animate({"margin-left":offsetX},options.speed),targetPage>0&&countPage-1>targetPage?($btnPrev.removeClass("page-btn-prev-disabled"),$btnNext.removeClass("page-btn-next-disabled")):0===targetPage?($btnPrev.addClass("page-btn-prev-disabled"),$btnNext.removeClass("page-btn-next-disabled")):targetPage===countPage-1&&($btnPrev.removeClass("page-btn-prev-disabled"),$btnNext.addClass("page-btn-next-disabled"))}function autoPlay(){return 0>=countPage?!1:void(timeoutAuto=setInterval(function(){curIndex+=1,curIndex>countPage-1&&(curIndex=0),slideList(curIndex)},options.delay))}var options,$listWrap,$list,$btnPrev,$btnNext,itemLength,itemWidth,itemHeight,itemPerSlide,countPage,timeoutAuto,$elm=$(elm),curIndex=0;return 0===$elm.length?$elm:$elm.length>1?($elm.each(function(){init($(this),opt)}),this):(options=$.extend({},defaults,opt),$listWrap=$elm.find(options.listWrapSelector),$list=$listWrap.find(options.listSelector),$btnPrev=$elm.find(options.prevBtnSelector),$btnNext=$elm.find(options.nextBtnSelector),itemWidth=options.itemWidth||$list.children(options.itemSelector).outerWidth(),itemHeight=options.itemHeight||$list.children(options.itemSelector).outerHeight()-1,itemLength=$list.children(options.itemSelector).length,itemPerSlide=4!==itemLength?Math.ceil($listWrap.width()/itemWidth):4,countPage=Math.ceil(itemLength/itemPerSlide),1===countPage&&($btnPrev.hide(),$btnNext.hide()),$listWrap.css({height:itemHeight}),$list.css({width:itemWidth*itemLength,"margin-left":0}),$btnPrev.addClass("page-btn-prev-disabled"),1>=countPage&&$btnNext.addClass("page-btn-next-disabled"),options.autoPlay&&(autoPlay(),$elm.on({mouseenter:function(){timeoutAuto&&clearInterval(timeoutAuto)},mouseleave:function(){autoPlay()}})),$btnPrev.off().on("click",function(e){e.preventDefault(),$(this).hasClass("page-btn-prev-disabled")||(curIndex-=1,0>=curIndex&&(curIndex=0,$(this).addClass("page-btn-prev-disabled")),$btnNext.removeClass("page-btn-next-disabled"),slideList(curIndex))}),void $btnNext.off().on("click",function(e){e.preventDefault(),$(this).hasClass("page-btn-next-disabled")||(curIndex+=1,curIndex>countPage-1&&(curIndex=countPage-1,$(this).addClass("page-btn-next-disabled")),$btnPrev.removeClass("page-btn-prev-disabled"),slideList(curIndex))}))}var defaults;return defaults={listWrapSelector:".J_carouselWrap",listSelector:".J_carouselList",itemSelector:"li",prevBtnSelector:".J_carouselPrev",nextBtnSelector:".J_carouselNext",itemWidth:null,itemHeight:null,autoPlay:!0,speed:500,delay:5e3},{init:init}}(),XIAOMI.namespace("app.search"),XIAOMI.app.search={speed:200,inputObj:null,keyword:null,init:function(){var timeoutFocus,_this=this,timeOut=null,$searchForm=$("#J_searchForm"),searchConfig={};_this.inputObj=$searchForm.find(".search-text"),_this.inputObj.data("search-config")&&(searchConfig=$.parseJSON(_this.inputObj.data("search-config").replace(/'/g,'"'))),$searchForm.append($('<div id="J_keywordList" class="keyword-list hide"><ul class="result-list"></ul></div>')),_this.inputObj.on({focus:function(){window.clearTimeout(timeoutFocus),$("#J_keywordList").css("opacity",1),$searchForm.addClass("search-form-focus"),!$(this).val()&&searchConfig.defaultWords&&_this.formatData(searchConfig.defaultWords)},blur:function(){$("#J_keywordList").css("opacity",0),timeoutFocus=window.setTimeout(function(){$searchForm.removeClass("search-form-focus")},200)},keyup:function(e){$.trim($(this).val()).length<=0&&searchConfig.defaultWords&&(_this.keyword=null,_this.formatData(searchConfig.defaultWords)),_this.focusMove(e.which),clearTimeout(timeOut),40!==e.which&&38!==e.which&&(timeOut=setTimeout(function(){_this.keyword=_this.inputObj.val(),_this.getResult(_this.keyword)},_this.speed))}}),$searchForm.on("mouseenter","#J_keywordList li",function(){$(this).addClass("current").siblings().removeClass("current")}),_this.submit()},getResult:function(k){var _this=this;k&&$.ajax({type:"GET",url:XIAOMI.GLOBAL_CONFIG.wwwSite+"/search/tips?keyword="+encodeURIComponent(k),dataType:"jsonp",jsonp:"jsonpcallback",jsonpCallback:"xmsearch",cache:!0,success:function(data){data.length>0?_this.inputObj.val()&&_this.formatData(data):_this.removeList()}})},formatData:function(data){for(var listHtml="",i=0,lens=data.length;lens>i;i+=1){var keywordStr=data[i].replace(this.keyword,'<span class="keyword">'+this.keyword+"</span> ");listHtml+='<li data-key="'+data[i]+'"><a href="'+XIAOMI.GLOBAL_CONFIG.wwwSite+"/search_"+encodeURIComponent(data[i])+'">'+keywordStr+"</a></li>"}$("#J_keywordList").removeClass("hide").children(".result-list").html(listHtml)},focusMove:function(keyCode){var _this=this,$keywordList=$("#J_keywordList"),$items=$keywordList.find("li"),i=$keywordList.find(".current").index()||0,lens=$items.length-1;if(38===keyCode){if(i-=1,0>i)return i=0,!1;$items.eq(i).addClass("current").siblings().removeClass("current"),_this.inputObj.val($items.eq(i).attr("data-key"))
}else if(40===keyCode){if(i+=1,i>lens)return i=lens,!1;$items.eq(i).addClass("current").siblings().removeClass("current"),_this.inputObj.val($items.eq(i).attr("data-key"))}},removeList:function(){$("#J_keywordList").addClass("hide").children(".result-list").html("")},submit:function(){var _this=this;$("#J_searchForm").on("submit",function(){var val=$.trim(_this.inputObj.val());return""!==val&&(val=val.replace(/[\-_'=+|\\\/]/g," "),window.location.href=XIAOMI.GLOBAL_CONFIG.wwwSite+"/search_"+encodeURIComponent(val)),!1})}},XIAOMI.namespace("app.selector"),XIAOMI.app.selector={defaultOption:{reorder:!1,buildLI:function(index,obj,elmUL){var objLI=$('<li data-index="'+index+'"><span>'+obj.text+"</span></li>");obj.selected&&objLI.addClass("selected"),elmUL.append(objLI)},afterChange:function(){}},init:function(elm,opt){function reorderList(elm){elm.insertBefore(elm.closest("ul").children("li")[0]),elmText.text(elm.text())}var options,elmSelect,elmWrap,elmText,elmList,elmArrow,_this=this,data=[];return 0===elm.length?elm:elm.length>1?(elm.each(function(){_this.init($(this),opt)}),this):(options=$.extend({},_this.defaultOption,opt),elmSelect=elm,elmWrap=$('<div class="xm-select"></div>').insertAfter(elmSelect),elmText=$('<div class="dropdown-text"></div>'),elmList=$('<ul class="dropdown-menu"></ul>'),elmArrow=$('<span class="arrow-down"></span>'),elmSelect.children("option").each(function(){data.push({text:$(this).text(),value:$(this).attr("value"),selected:$(this).attr("selected")})}),$(data).each(function(index,obj){options.buildLI(index,obj,elmList)}),elmWrap.append(elmText,elmList,elmArrow,elmSelect),elmSelect.hide(),options.reorder===!0&&0!==elmList.children("li").index(elmList.children(".selected"))?reorderList(elmList.children(".selected")):elmText.text(data[0].text),elmList.on("click","li",function(){var val=elmSelect.children("option").eq($(this).attr("data-index")).val();elmSelect.val(val).change(),$(this).addClass("selected").siblings("li").removeClass("selected"),options.reorder===!0?0!==elmList.children("li").index(this)&&(reorderList($(this)),elmList.hide()):(elmText.text($(this).text()),elmList.hide()),options.afterChange(val)}),void elmWrap.on({mouseover:function(){elmWrap.addClass("toggled"),elmList.show()},mouseout:function(){elmWrap.removeClass("toggled"),elmList.hide()}}))}},XIAOMI.namespace("app.setLoginInfo"),XIAOMI.app.setLoginInfo={data:{userId:0,userName:"",goodsNum:0},miid:parseInt(XIAOMI.app.cookie("userId")),defautConfig:{},init:function(globalConfig){var _this=this;this.config=$.extend({},globalConfig,this.defautConfig),this.uuidCookie(),this.miid&&0!=this.miid?(this.data.userName=this.miid?XIAOMI.app.cookie("XM_"+this.miid+"_UN"):"",this.data.goodsNum=XIAOMI.app.cookie("xm_user_www_num"),this.data.goodsNum=null==this.data.goodsNum?0:this.data.goodsNum,null==this.data.userName||""===this.data.userName?_this.createScript(this.miid):this.updateDom(this.miid)):$.ajax({dataType:"JSONP",url:"http://userid.xiaomi.com/userId",jsonpCallback:"userLogincallback",success:function(data){if(0!=data.userId&&null!=data.userId){var option={path:"/",domain:".mi.com"};XIAOMI.app.cookie("userId",data.userId,option),_this.createScript(data.userId)}}})},createScript:function(uid){this.updateDom(uid);var script=document.createElement("script");script.src="https://account.xiaomi.com/pass/userInfoJsonP?userId="+uid+"&callback=setLoginInfo_getAccountInfo",script.type="text/javascript",script.async=!0,document.getElementsByTagName("head")[0].appendChild(script)},updateDom:function(uid){var displayName=this.data.userName;null!=displayName&&""!==displayName?displayName.length>7&&(displayName=displayName.substr(0,7)+"…"):displayName=uid;var randomStr="undefined"!=typeof XIAOMI.app.cookie("userId")?XIAOMI.app.cookie("userId"):"";randomStr+="_t"+(new Date).getTime();var timeoutUserMenu,html='欢迎您 <b class="user-name">'+displayName+'<span class="arrow"></span></b><span class="sep">|</span><a href="'+this.config.orderSite+"/user/order?r="+randomStr+'">我的订单</a><span class="sep">|</span><a href="http://account.xiaomi.com/" target="_blank">我的小米账户</a>',$userInfoMenu=$('<div class="user-info-menu"><ul><li><a href="http://my.mi.com/portal" target="_blank">个人中心</a></li><li><a href="'+XIAOMI.GLOBAL_CONFIG.orderSite+'/user/favorite">我的收藏</a></li><li><a href="'+this.config.logoutUrl+'">退出登录</a></li></ul><span class="menu-arrow"></span></div>');$(".J_userInfo").html(html).append($userInfoMenu).on({mouseenter:function(){timeoutUserMenu&&window.clearTimeout(timeoutUserMenu),$userInfoMenu.show()},mouseleave:function(){timeoutUserMenu=window.setTimeout(function(){$userInfoMenu.hide()},200)}},".user-name"),$userInfoMenu.on({mouseenter:function(){timeoutUserMenu&&window.clearTimeout(timeoutUserMenu)},mouseleave:function(){timeoutUserMenu=window.setTimeout(function(){$userInfoMenu.hide()},200)}})},uuidCookie:function(){var myUuidValue=("xmguest-"+uuid.v1()).toUpperCase(),myUuid=XIAOMI.app.cookie("xmuuid");if(!myUuid){var option={path:"/",domain:".mi.com",expires:18250};XIAOMI.app.cookie("xmuuid",myUuidValue,option)}}};var setLoginInfo_getAccountInfo=function(data){var _this=XIAOMI.app.setLoginInfo;if(data.userId){_this.data.userName=data.uniqName?data.uniqName:data.userId;var option={path:"/",domain:".mi.com"};XIAOMI.app.cookie("XM_"+_this.miid+"_UN",_this.data.userName,option),_this.updateDom(data.userId)}};XIAOMI.namespace("setRecommend"),XIAOMI.app.setRecommend=function(options){var option={obj:$("#item-recommend-box"),tmpl:$("#item-recommend-template"),url:XIAOMI.GLOBAL_CONFIG.sideBarApiUrl+"cart/get/id/1134900361,1134900465,1135000458,1140400001/callback/itemRecommend/cid/2",max:5,min:0,callback:null};$.extend(option,options||{}),$(option.obj).show(),$.ajax({dataType:"JSONP",url:option.url,jsonpCallback:"itemRecommend",success:function(data){var template=doT.template($(option.tmpl).html()),result=data.result,itemList=[];for(var item in result)item<option.max&&itemList.push(result[item]);return itemList.length<option.min?!1:void(0!==itemList.length&&"error"!==result?($(option.obj).html(template(itemList)),null!==option.callback&&"function"==typeof option.callback&&option.callback()):$(option.obj).hide())}})};;+function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]};return!1}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one($.support.transition.end,function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),this},$(function(){$.support.transition=transitionEnd()})}(jQuery);;!function($){"use strict";var Modal=function(element,options){this.options=options,this.$element=$(element).delegate('[data-dismiss="modal"]',"click.dismiss.modal",$.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};Modal.prototype={constructor:Modal,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var that=this,e=$.Event("show");this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(document.body),that.$element.show(),transition&&that.$element[0].offsetWidth,that.$element.addClass("in").attr("aria-hidden",!1),that.enforceFocus(),transition?that.$element.one($.support.transition.end,function(){that.$element.focus().trigger("shown")}):that.$element.focus().trigger("shown")}))},hide:function(e){e&&e.preventDefault();e=$.Event("hide"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),$(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),$.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var that=this;$(document).on("focusin.modal",function(e){that.$element[0]===e.target||that.$element.has(e.target).length||that.$element.focus()})},escape:function(){var that=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(e){27==e.which&&that.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var that=this,timeout=setTimeout(function(){that.$element.off($.support.transition.end),that.hideModal()},500);this.$element.one($.support.transition.end,function(){clearTimeout(timeout),that.hideModal()})},hideModal:function(){var that=this;this.$element.hide(),this.backdrop(function(){that.removeBackdrop(),that.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(callback){var animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate,pageHeight=$(document).height(),pageWidth="100%";if(this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(document.body),this.$backdrop.css({width:pageWidth,height:pageHeight}).click("static"==this.options.backdrop?$.proxy(this.$element[0].focus,this.$element[0]):$.proxy(this.hide,this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!callback)return;doAnimate?this.$backdrop.one($.support.transition.end,callback):callback()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one($.support.transition.end,callback):callback()):callback&&callback()}};var old=$.fn.modal;$.fn.modal=function(option){return this.each(function(){var $this=$(this),data=$this.data("modal"),options=$.extend({},$.fn.modal.defaults,$this.data(),"object"==typeof option&&option);data||$this.data("modal",data=new Modal(this,options)),"string"==typeof option?data[option]():options.show&&data.show()})},$.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());e.preventDefault(),$target.modal(option).one("hide",function(){$this.focus()})})}(window.jQuery);;!function(){"use strict";function encodeHTMLSource(){var encodeHTMLRules={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},matchHTML=/&(?!#?\w+;)|<|>|"|'|\//g;return function(){return this?this.replace(matchHTML,function(m){return encodeHTMLRules[m]||m}):this}}function resolveDefs(c,block,def){return("string"==typeof block?block:block.toString()).replace(c.define||skip,function(m,code,assign,value){return 0===code.indexOf("def.")&&(code=code.substring(4)),code in def||(":"===assign?(c.defineParams&&value.replace(c.defineParams,function(m,param,v){def[code]={arg:param,text:v}}),code in def||(def[code]=value)):new Function("def","def['"+code+"']="+value)(def)),""}).replace(c.use||skip,function(m,code){c.useParams&&(code=code.replace(c.useParams,function(m,s,d,param){if(def[d]&&def[d].arg&&param){var rw=(d+":"+param).replace(/'|\\/g,"_");return def.__exp=def.__exp||{},def.__exp[rw]=def[d].text.replace(new RegExp("(^|[^\\w$])"+def[d].arg+"([^\\w$])","g"),"$1"+param+"$2"),s+"def.__exp['"+rw+"']"}}));var v=new Function("def","return "+code)(def);return v?resolveDefs(c,v,def):v})}function unescape(code){return code.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var global,doT={version:"1.0.0",templateSettings:{evaluate:/\{\{([\s\S]+?\}?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1},template:void 0,compile:void 0};"undefined"!=typeof module&&module.exports?module.exports=doT:"function"==typeof define&&define.amd?define(function(){return doT}):(global=function(){return this||(0,eval)("this")}(),global.doT=doT),String.prototype.encodeHTML=encodeHTMLSource();var startend={append:{start:"'+(",end:")+'",endencode:"||'').toString().encodeHTML()+'"},split:{start:"';out+=(",end:");out+='",endencode:"||'').toString().encodeHTML();out+='"}},skip=/$^/;doT.template=function(tmpl,c,def){c=c||doT.templateSettings;var needhtmlencode,indv,cse=c.append?startend.append:startend.split,sid=0,str=c.use||c.define?resolveDefs(c,tmpl,def||{}):tmpl;str=("var out='"+(c.strip?str.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):str).replace(/'|\\/g,"\\$&").replace(c.interpolate||skip,function(m,code){return cse.start+unescape(code)+cse.end}).replace(c.encode||skip,function(m,code){return needhtmlencode=!0,cse.start+unescape(code)+cse.endencode}).replace(c.conditional||skip,function(m,elsecase,code){return elsecase?code?"';}else if("+unescape(code)+"){out+='":"';}else{out+='":code?"';if("+unescape(code)+"){out+='":"';}out+='"}).replace(c.iterate||skip,function(m,iterate,vname,iname){return iterate?(sid+=1,indv=iname||"i"+sid,iterate=unescape(iterate),"';var arr"+sid+"="+iterate+";if(arr"+sid+"){var "+vname+","+indv+"=-1,l"+sid+"=arr"+sid+".length-1;while("+indv+"<l"+sid+"){"+vname+"=arr"+sid+"["+indv+"+=1];out+='"):"';} } out+='"}).replace(c.evaluate||skip,function(m,code){return"';"+unescape(code)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,"").replace(/(\s|;|\}|^|\{)out\+=''\+/g,"$1out+="),needhtmlencode&&c.selfcontained&&(str="String.prototype.encodeHTML=("+encodeHTMLSource.toString()+"());"+str);try{return new Function(c.varname,str)}catch(e){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+str),e}},doT.compile=function(tmpl,def){return doT.template(tmpl,null,def)}}();;~function(a){"use strict";var c,j,b={propertyName:"data-stat-id",page:"10",area:["0","2","3"],diyArea:!1,digits:{area:2,point:3},urlParam:"stat",hashParam:"pcid",needMap:!0,jsonpName:"linkSignstreamData",jsonpActivityName:"linkSignActivityDate",domain:".mi.com",webSiteID:100,arrayLevel:[5,85,10]},d={parentLoop:!1,sonLoop:!1,url:{iframe:"http://stat.be.xiaomi.com/map/click/index",data:"http://stat.be.xiaomi.com/api/clickMap/get",popIframe:"http://stat.be.xiaomi.com/map/click/desc",logoutUrl:"http://stat.be.xiaomi.com/site/logout?map=click",activity:"http://stat.be.xiaomi.com/api/activity/getTime",pageurl:location.href.split("#")[0]},activeDataName:"data-stat-active",isFirstDraw:!0,datepickerStatic:{css:"http://hd.mi.com/webfile/zt/hd/2014091802/jquery-ui.css",js:"http://hd.mi.com/webfile/zt/hd/2014091802/jquery-ui.js"},pageID:function(){var a=location.href,b="?stat=true";return-1!=a.indexOf(b)&&(a=a.replace(b,"")),"79fe2eae924d2a2e"},PVArray:[],colorLevel:["#F8F89E","#CDF89E","#EC5540"]},e=function(a){var b,c=new RegExp("(^| )"+a+"=([^;]*)(;|$)");return(b=document.cookie.match(c))?unescape(b[2]):null},f=function(b,e,f){var h=a(b).find("a"),k={page:d.pageID(),point:null},l=h.length-1;e===f&&(d.parentLoop=!0),h.each(function(b,e){var n,o,p,f=a(e).attr("href")||"",h=a(e).text(),m=a(e).parent().parent().attr("class")||a(e).parent().parent().parent().attr("class")||"";f=-1!==f.indexOf(c.domain)?f.split("?")[0]:f,k.point=md5(f+h+m),n=a(e).attr("onclick")||"",o=g(i(k),f),p=o+n,a(e).attr(c.propertyName,i(k)).attr("onclick",p),d.parentLoop===!0&&b===l&&(d.sonLoop=!0,j.init())})},g=function(a,b){return a&&b?"_msq.push(['trackEvent', '"+a+"', '"+b+"', 'pcpid']);":""},h=function(a,b){var c,d;if(a=String(a),c=a.length,a.length<b)for(d=0;b-c>d;d++)a="0"+a;return a},i=function(a){var c,d,b=[];if("undefined"!=typeof a)for(c in a)d=a[c],d=null==d||""==d?"00":d,b.push(d);return b.join("-")};a.fn.linkSign=function(d){c=a.extend(b,d);var e=this.length-1;return this.each(function(a){f(this,a,e)})},j={init:function(){if(c.needMap&&this.getSearchName(c.urlParam,"search")&&"true"==this.getSearchName(c.urlParam,"search")){var a=/^\d{8}$/.test(this.getSearchName("startDate","search"))&&/^\d{8}$/.test(this.getSearchName("endDate","search")),b=a?this.getSearchName("startDate","search"):this.getLocaldate(0);this.getStatus(b,b)}},hashChange:function(){var f,g,b=this.getSearchName(c.hashParam,"hash"),e=d.pageID()+"-"+b;b&&(f=a("a["+c.propertyName+"="+e+"]"),f.offset()&&(g=f.offset().top-80,a("body").animate({scrollTop:g},1e3),a("p.linkSign-datepickerTips").removeClass("linkSign-positon-pop"),f.find("p.linkSign-datepickerTips").addClass("linkSign-positon-pop")))},getActivity:function(){var b="";return a.ajax({type:"GET",url:d.url.activity+"?webSiteId="+c.webSiteID,dataType:"jsonp",jsonp:"callback",cache:!0,jsonpCallback:c.jsonpActivityName,success:function(b){if(200==b.code){var c=b.datas.last.days;if(!b.datas.last)return;a("#linkSign-activity").html('<label><input type="radio" name="linkSign-quick" value="'+c+'"/> 最近活动</label>')}}}),b},getSearchName:function(a,b){var g,h,c="",d=!1,e="hash"==b?location.hash:location.search,f="hash"==b?"#":"?";if(0===e.length)return c;if(0==e.indexOf(f)&&e.indexOf("=")>1)for(g=e.substring(1,e.length).split("&"),h=0;h<g.length&&!d;)g[h].indexOf("=")>0&&g[h].split("=")[0].toLowerCase()==a.toLowerCase()&&(c=g[h].split("=")[1],d=!0),h++;return c},getStatus:function(b,f){var g=this,h=d.url.data+"?pid="+d.pageID()+"&startDate="+b+"&endDate="+f;h=e("userId")?h+"&userid="+e("userId"):h,a.ajax({type:"GET",url:h,dataType:"jsonp",jsonp:"callback",cache:!0,jsonpCallback:c.jsonpName,success:function(e){var h,i,j;if(200===e.code){h=e.datas,window.onhashchange=function(){g.hashChange()},g.createIframe(!0,b,f),d.isFirstDraw=!1,a(".linkSign-datepickerTips").remove();for(i in h)j=i,d.PVArray.push(parseInt(h[i].pv)),g.drawLinks(h[i],a("a["+c.propertyName+"="+j+"]"));g.setElementsLevel()}else(201===e.code||202===e.code)&&g.createIframe(!1,b,f)}})},setElementsLevel:function(){var b=this,c=b.quickSort(d.PVArray),e=a(".linkSign-datepickerTips");e.each(function(e,f){var g=parseInt(a(f).attr("data-stat-pv")),h=b._levelBorderLine(g,c);a(f).attr("data-stat-level",h).css({"background-color":d.colorLevel[h-1]})})},getLocaldate:function(a){var b=new Date,c=new Date(b.setDate(b.getDate()+a)),d=c.getFullYear(),e=h(c.getMonth()+1,2),f=h(c.getDate(),2),g=[d,e,f].join("");return g},createIframe:function(b,c,f){function h(b,c){var d=[b.substring(0,4),b.substring(4,6),b.substring(6,8)].join("-"),e=[c.substring(0,4),c.substring(4,6),c.substring(6,8)].join("-");a("#J-linkSign-startdate").datepicker("setDate",d),a("#J-linkSign-enddate").datepicker("setDate",e)}var i,j,k,g=this;if(d.isFirstDraw){if(this.createActiveStatic(),i='<div class="linkSign-placeholder"></div><div class="linkSign-datepickerBox J_linkSign-fixed">选择日期: <input type="text" value="" class="datepicker J_linkSign-datepicker" id="J-linkSign-startdate" /> 至 <input type="text" value="" class="datepicker J_linkSign-datepicker" id="J-linkSign-enddate" /><a href="Javascript:void(0);" class="datepicker-submit J_linkSign-datepicker-submit">GO</a>&nbsp;&nbsp;&nbsp;快捷时间选项： <label><input type="radio" name="linkSign-quick" value="0" checked/> 今日</label>  <label><input type="radio" name="linkSign-quick" value="-1" /> 昨日</label>  <label><input type="radio" name="linkSign-quick" value="-2"/> 最近3日</label> <label><input type="radio" name="linkSign-quick" value="-6"/> 最近七日</label><label id="linkSign-activity"></label><span class="linkSign-logout"><a href="'+d.url.logoutUrl+'">退出</a></span></div><div class="linkSign-filter"><p class="linkSign-filter-iframe" data-stat-switch="off" title="锁定页头"></p><p class="linkSign-filter-data" data-stat-switch="off" title="PV,UV,IP全部显示"></p><p class="linkSign-filter-switch" data-stat-switch="on" title="关闭数据"></p><ul class="linkSign-filter-ul"><li class="linkSign-level-3" data-stat-switch="off" title="数据排行前5%">3</li><li class="linkSign-level-2" data-stat-switch="off"  title="数据排行中间90%">2</li><li class="linkSign-level-1" data-stat-switch="off" title="数据排行后5%">1</li></ul></div>',j=d.url.iframe+"?pid="+d.pageID()+"&startDate="+c+"&endDate="+f+"&url="+encodeURIComponent(d.url.pageurl),j=e("userId")?j+"&userid="+e("userId"):j,k="<iframe src='"+j+"' width='100%' height='330' name='linkSign-frameDrawing' id='linkSign-frameDrawing' class='J_linkSign-fixed' frameborder='0' scrolling='no'></iframe>",!b)return a("body").prepend(k),void 0;a("body").prepend(i+k),g.getActivity(),a.getScript(d.datepickerStatic.js,function(){a.datepicker.regional["zh-CN"]={closeText:"关闭",prevText:"<上月",nextText:"下月>",currentText:"今天",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一","二","三","四","五","六","七","八","九","十","十一","十二"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"},a.datepicker.setDefaults(a.datepicker.regional["zh-CN"]),a("#J-linkSign-startdate").datepicker({onClose:function(b){a("#J-linkSign-enddate").datepicker("option","minDate",b)}}),a("#J-linkSign-enddate").datepicker({maxDate:0,onClose:function(b){a("#J-linkSign-startdate").datepicker("option","maxDate",b)}}),h(c,f)}),a(".J_linkSign-datepicker-submit").on("click",function(){var b=a("#J-linkSign-startdate").val().split("-").join(""),c=a("#J-linkSign-enddate").val().split("-").join("");""!=b&&""!=c&&(a("input[name=linkSign-quick]").attr("checked",!1),g.getStatus(b,c))}),a(".J_linkSign-fixed").on("click","input[name=linkSign-quick]",function(){var b,c,d=parseInt(a(this).val());d>100?b=c=d.toString():(b=g.getLocaldate(d),c=-1==d?g.getLocaldate(-1):g.getLocaldate(0)),g.getStatus(b,c),h(b,c)}),a(".linkSign-filter-ul").on("click","li",function(){var b=a(this).text(),c=a(this).attr("data-stat-switch"),d=a(".linkSign-datepickerTips"),e=a(".linkSign-datepickerTips[data-stat-level="+b+"]");"off"===c?(d.hide(),e.show(),a(this).attr("data-stat-switch","on").addClass("linkSign-side-selected").siblings("li").removeClass("linkSign-side-selected").attr("data-stat-switch","off")):(d.show(),a(this).removeClass("linkSign-side-selected").attr("data-stat-switch","off"))}),a(".linkSign-filter-switch").on("click",function(){var b=a(".linkSign-datepickerTips"),c=a(this).attr("data-stat-switch");"off"===c?(b.show(),a(this).attr("data-stat-switch","on").removeClass("on").attr("title","关闭数据")):(b.hide(),a(this).attr("data-stat-switch","off").addClass("on").attr("title","打开数据")),a(".linkSign-filter-ul").find("li").removeClass("linkSign-side-selected")}),a(".linkSign-filter-data").on("click",function(){var b=a(".linkSign-datepickerTips"),c=a(this).attr("data-stat-switch");"off"===c?(b.find("span").show(),a(this).attr("data-stat-switch","on").addClass("on").attr("title","只显示PV")):(b.find(".linkSign-pop-pv").show().siblings("span").hide(),a(this).attr("data-stat-switch","off").removeClass("on").attr("title","PV,UV,IP全部显示"))}),a(".linkSign-filter-iframe").on("click",function(){var b=a(this).attr("data-stat-switch");"off"===b?(a(".J_linkSign-fixed").css({position:"fixed"}),a(".linkSign-placeholder").show(),a(this).attr("data-stat-switch","on").addClass("on").attr("title","解除锁定")):(a(".J_linkSign-fixed").css({position:"static"}),a(".linkSign-placeholder").hide(),a(this).attr("data-stat-switch","off").removeClass("on").attr("title","锁定页头"))})}else a("#linkSign-frameDrawing").attr("src",d.url.iframe+"?pid="+d.pageID()+"&startDate="+c+"&endDate="+f+"&url="+encodeURIComponent(d.url.pageurl))},createActiveStatic:function(){a("head").append('<link rel="stylesheet" type="text/css" href="'+d.datepickerStatic.css+'" /><style>.linkSign-placeholder{display:none;height:390px;}#linkSign-frameDrawing,.linkSign-datepickerBox,.linkSign-filter{z-index:9998;width:100%;}#linkSign-frameDrawing{top:50px;border-bottom: 1px solid gray;box-shadow: 1px 11px 9px #999;}.linkSign-datepickerBox{background-color:#fff;top:0;padding:10px 0 0 0;font-size:12px;color:#8c8c8c;height:40px;text-indent:15px;}.datepicker,.datepicker-submit{height:24px;line-height:24px;border:1px solid #ccc;}.linkSign-frameDrawing{margin-left:10px;}.linkSign-datepickerBox label{margin-right:10px;}.datepicker-submit{margin:0 10px;display:inline-block;width:50px;background-color:#ff6600;color:#fff;border-color:#ff6600;}.datepicker-submit:hover{color:#fff;font-weight:400;}.linkSign-datepickerTips{text-shadow:1px 1px 1px #ffffff;transition:All 0.2s ease-in-out;z-index:9996}.linkSign-datepickerTips:hover{z-index:9997;transform:scale(1.2);}.linkSign-filter{position:fixed;width:32px;right:5px;top:50%;margin-top:-160px;z-index:9999;}.linkSign-filter-ul{margin:0;padding:0;}.linkSign-filter-ul li{width:32px;height:32px;list-style:none;cursor:pointer;text-indent:-9999px;}.linkSign-level-1{background-color:'+d.colorLevel[0]+";}.linkSign-level-2{background-color:"+d.colorLevel[1]+";}.linkSign-level-3{background-color:"+d.colorLevel[2]+";}.linkSign-filter-ul li.linkSign-side-selected{box-shadow:1px 1px 6px #666 inset;}.linkSign-filter-iframe,.linkSign-filter-switch,.linkSign-filter-data{background-color:#fff;background-image:url(http://img03.mifile.cn/webfile/images/2014/cn/icon/linksign-icons-select.png?1);width:30px;height:30px;line-height:30px;margin:0;padding:0;text-align:center;cursor:pointer;border:1px solid #eaeaea;font-size:12px;text-indent:-9999px;background-repeat:no-repeat;border-bottom:0;}.linkSign-filter-iframe{background-position: 3px -31px;}.linkSign-filter-switch{background-position: 3px -167px;}.linkSign-filter-data{background-position: 3px -99px;}.linkSign-filter-iframe.on{background-position: 3px 3px;}.linkSign-filter-switch.on{background-position: 3px -133px;}.linkSign-filter-data.on{background-position: 3px -65px;}.linkSign-pop-ip,.linkSign-pop-uv{display:none;}.linkSign-popiframe-wrap{background-color:#ffffff;width:400px;position:absolute;z-index:9997;box-shadow:0 5px 15px rgba(0, 0, 0, 0.5);border-radius:6px;}.J_linkSign-popiframe{border-radius:6px}.linkSign-popiframe-title{text-align:right;padding:5px;background-color:#B980B5;border-radius:5px 5px 0 0;}.linkSign-popiframe-title span{display:inline-block;width:24px;height:24px;line-height:22px;border-radius:20px;background-color:#f8f8f8;text-align:center;transition:All 0.4s ease-in-out;-webkit-transition:All 0.4s ease-in-out;cursor:pointer;}.linkSign-popiframe-title span:hover{transform:rotate(360deg);-webkit-transform:rotate(360deg);background-color:#f2f2f2;}.linkSign-popiframe-wrap{-webkit-animation:fadeInUp .5s .2s ease both;-moz-animation:fadeInUp 1s .2s ease both;}@-webkit-keyframes fadeInUp{0%{opacity:0;-webkit-transform:translateY(20px)}100%{opacity:1;-webkit-transform:translateY(0)}}@-moz-keyframes fadeInUp{0%{opacity:0;-moz-transform:translateY(20px)}100%{opacity:1;-moz-transform:translateY(0)}}.linkSign-popiframe-pop{-webkit-animation:bounce 1s infinite ease both;-moz-animation:bounce 1s infinite ease both;}.linkSign-positon-pop{-webkit-animation:bounce 1s 8 ease both;-moz-animation:bounce 1s 8 ease both;}@-webkit-keyframes bounce{0%,20%,50%,80%,100%{-webkit-transform:translateY(0)}40%{-webkit-transform:translateY(-30px)}60%{-webkit-transform:translateY(-15px)}}@-moz-keyframes bounce{0%,20%,50%,80%,100%{-moz-transform:translateY(0)}40%{-moz-transform:translateY(-30px)}60%{-moz-transform:translateY(-15px)}}.linkSign-logout{float:right;margin-right:42px;}</style>")},createPopIframe:function(b){var e=b.attr(c.propertyName).split("-"),f={start:a("#J-linkSign-startdate").val().split("-").join(""),end:a("#J-linkSign-enddate").val().split("-").join("")},g=d.url.popIframe+"?pid="+e[0]+"&pcid="+e[1]+"&startDate="+f.start+"&endDate="+f.end,h=a(window).width(),i=b.offset().left,j={left:i>=h-400?h-480:i,top:b.offset().top+30},k="<div class='linkSign-popiframe-wrap' style='left:"+j.left+"px;top:"+j.top+"px;'><div class='linkSign-popiframe-title'><span class='J_linkSign-popiframe-close'><img src='http://img03.mifile.cn/webfile/images/2014/cn/icon/linksign-icon-close.png' width='16px' alt='关闭' title='关闭'/></span></div><iframe src='"+g+"' width='100%' height='340' name='linkSign-popiframe' id='linkSign-popiframe' class='J_linkSign-popiframe' frameborder='0' scrolling='no'></iframe></div>";a(".J_linkSign-popiframe-close").click(),a("body").append(k),b.find(".linkSign-datepickerTips").addClass("linkSign-popiframe-pop"),a(".J_linkSign-popiframe-close").on("click",function(){b.find(".linkSign-datepickerTips").removeClass("linkSign-popiframe-pop"),a(this).parent().parent().remove()})},drawLinks:function(b,c){var d=this,e=b.pv,f=b.uv,g=b.ip,h="position:absolute;left:0;top:0;background-color:#d2faf8;padding:0 5px;color:#333;font-size:12px;line-height:1.8;border-radius:20px;margin:0;box-shadow:3px 3px 5px #666;border:1px solid #cccccc;",i="点击量："+e+"&#13;独立用户数UV："+f+"&#13;IP："+g,j="<p data-stat-pv="+e+' class="linkSign-datepickerTips" title='+i+' style="'+h+'"><span class="linkSign-pop-pv">'+e+'</span><span class="linkSign-pop-uv">/'+f+'</span><span class="linkSign-pop-ip">/'+g+"</span></p>",k={position:"absolute"==c.css("position")?"absolute":"relative","text-indent":"0",overflow:"inherit"},l={overflow:"inherit"};c.css(k).prepend(j).on("click",function(b){var e=a(b.target).attr("class");return-1!=e.indexOf("linkSign-")?(d.createPopIframe(c),!1):void 0}).parent().css(l).parent().css(l)},quickSort:function(a){var b,c,d,e,f;if(a.length<=1)return a;for(b=Math.floor(a.length/2),c=a.splice(b,1)[0],d=[],e=[],f=0;f<a.length;f++)a[f]<c?d.push(a[f]):e.push(a[f]);return this.quickSort(d).concat([c],this.quickSort(e))},_levelBorderLine:function(a,b){var g,h,i,d=b.length,e=[],f=c.arrayLevel;for(g=0;g<f.length;g++){for(h=0,i=0;g>i;i++)h+=f[i];0!==h&&e.push(b[parseInt(d*h/100)-1])}return e.push(a),e.sort(function(a,b){return a-b}),e.indexOf(a)+1}}}(window.jQuery),function(a){"use strict";function b(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function c(a,b){return a<<b|a>>>32-b}function d(a,d,e,f,g,h){return b(c(b(b(d,a),b(f,h)),g),e)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,c){a[c>>5]|=128<<c%32,a[(c+64>>>9<<4)+14]=c;var d,i,j,k,l,m=1732584193,n=-271733879,o=-1732584194,p=271733878;for(d=0;d<a.length;d+=16)i=m,j=n,k=o,l=p,m=e(m,n,o,p,a[d],7,-680876936),p=e(p,m,n,o,a[d+1],12,-389564586),o=e(o,p,m,n,a[d+2],17,606105819),n=e(n,o,p,m,a[d+3],22,-1044525330),m=e(m,n,o,p,a[d+4],7,-176418897),p=e(p,m,n,o,a[d+5],12,1200080426),o=e(o,p,m,n,a[d+6],17,-1473231341),n=e(n,o,p,m,a[d+7],22,-45705983),m=e(m,n,o,p,a[d+8],7,1770035416),p=e(p,m,n,o,a[d+9],12,-1958414417),o=e(o,p,m,n,a[d+10],17,-42063),n=e(n,o,p,m,a[d+11],22,-1990404162),m=e(m,n,o,p,a[d+12],7,1804603682),p=e(p,m,n,o,a[d+13],12,-40341101),o=e(o,p,m,n,a[d+14],17,-1502002290),n=e(n,o,p,m,a[d+15],22,1236535329),m=f(m,n,o,p,a[d+1],5,-165796510),p=f(p,m,n,o,a[d+6],9,-1069501632),o=f(o,p,m,n,a[d+11],14,643717713),n=f(n,o,p,m,a[d],20,-373897302),m=f(m,n,o,p,a[d+5],5,-701558691),p=f(p,m,n,o,a[d+10],9,38016083),o=f(o,p,m,n,a[d+15],14,-660478335),n=f(n,o,p,m,a[d+4],20,-405537848),m=f(m,n,o,p,a[d+9],5,568446438),p=f(p,m,n,o,a[d+14],9,-1019803690),o=f(o,p,m,n,a[d+3],14,-187363961),n=f(n,o,p,m,a[d+8],20,1163531501),m=f(m,n,o,p,a[d+13],5,-1444681467),p=f(p,m,n,o,a[d+2],9,-51403784),o=f(o,p,m,n,a[d+7],14,1735328473),n=f(n,o,p,m,a[d+12],20,-1926607734),m=g(m,n,o,p,a[d+5],4,-378558),p=g(p,m,n,o,a[d+8],11,-2022574463),o=g(o,p,m,n,a[d+11],16,1839030562),n=g(n,o,p,m,a[d+14],23,-35309556),m=g(m,n,o,p,a[d+1],4,-1530992060),p=g(p,m,n,o,a[d+4],11,1272893353),o=g(o,p,m,n,a[d+7],16,-155497632),n=g(n,o,p,m,a[d+10],23,-1094730640),m=g(m,n,o,p,a[d+13],4,681279174),p=g(p,m,n,o,a[d],11,-358537222),o=g(o,p,m,n,a[d+3],16,-722521979),n=g(n,o,p,m,a[d+6],23,76029189),m=g(m,n,o,p,a[d+9],4,-640364487),p=g(p,m,n,o,a[d+12],11,-421815835),o=g(o,p,m,n,a[d+15],16,530742520),n=g(n,o,p,m,a[d+2],23,-995338651),m=h(m,n,o,p,a[d],6,-198630844),p=h(p,m,n,o,a[d+7],10,1126891415),o=h(o,p,m,n,a[d+14],15,-1416354905),n=h(n,o,p,m,a[d+5],21,-57434055),m=h(m,n,o,p,a[d+12],6,1700485571),p=h(p,m,n,o,a[d+3],10,-1894986606),o=h(o,p,m,n,a[d+10],15,-1051523),n=h(n,o,p,m,a[d+1],21,-2054922799),m=h(m,n,o,p,a[d+8],6,1873313359),p=h(p,m,n,o,a[d+15],10,-30611744),o=h(o,p,m,n,a[d+6],15,-1560198380),n=h(n,o,p,m,a[d+13],21,1309151649),m=h(m,n,o,p,a[d+4],6,-145523070),p=h(p,m,n,o,a[d+11],10,-1120210379),o=h(o,p,m,n,a[d+2],15,718787259),n=h(n,o,p,m,a[d+9],21,-343485551),m=b(m,i),n=b(n,j),o=b(o,k),p=b(p,l);return[n,o]}function j(a){var b,c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(255&a[b>>5]>>>b%32);return c}function k(a){var b,c=[];for(c[(a.length>>2)-1]=void 0,b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(255&a.charCodeAt(b/8))<<b%32;return c}function l(a){return j(i(k(a),8*a.length))}function m(a,b){var c,g,d=k(a),e=[],f=[];for(e[15]=f[15]=void 0,d.length>16&&(d=i(d,8*a.length)),c=0;16>c;c+=1)e[c]=909522486^d[c],f[c]=1549556828^d[c];return g=i(e.concat(k(b)),512+8*b.length),j(i(f.concat(g),640))}function n(a){var d,e,b="0123456789abcdef",c="";for(e=0;e<a.length;e+=1)d=a.charCodeAt(e),c+=b.charAt(15&d>>>4)+b.charAt(15&d);return c}function o(a){return unescape(encodeURIComponent(a))}function p(a){return l(o(a))}function q(a){return n(p(a))}function r(a,b){return m(o(a),o(b))}function s(a,b){return n(r(a,b))}function t(a,b,c){return b?c?r(b,a):s(b,a):c?p(a):q(a)}"function"==typeof define&&define.amd?define(function(){return t}):a.md5=t}(this);
